<app-header style="display: block!important;"></app-header>


<main class="container mt-3" style="margin-bottom: 125px;">

    <h1 class="text-white">Minuta de reuniones</h1>

    <div *ngIf="this.spinner" class="container mt-3">
        <h3 class="text-white text-center">Espere por favor...</h3>
        <div class="d-flex justify-content-center">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>

    <form *ngIf="!this.spinner" [formGroup]="minutaForm" (ngSubmit)="guardar()">

        <div class="row">
            <h2 class="text-white">Datos generales</h2>
            <div class="col-4">
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-fecha">Fecha</span>
                    <input type="date" class="form-control" name="fecha" id="formFecha" formControlName="fecha">
                </div>
            </div>

            <div class="col-4">
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-hora">Hora</span>
                    <input type="time" class="form-control" name="hora" id="formHora" formControlName="hora">
                </div>
            </div>

            <div class="col-4">
                <div class="input-group mb-3">
                    <span class="input-group-text" id="basic-numReunion">N° de reunión</span>
                    <input type="text" class="form-control" name="numReunion" formControlName="numReunion"
                        id="formNumReunion" readonly>
                </div>
            </div>
        </div>

        <div class="row">
            <h2 class="text-white">Asistentes</h2>
            <div class="col-12 mb-3">
                <div class="input-group">

                    <span class="input-group-text">Nombre </span>
                    <input class="form-control" [formControl]="nuevoAsistente" placeholder="Agregar nuevo asistente">
                    <button class="btn btn-outline-primary ms-2" type="button" (click)="agregarAsistente()">
                        Agregar
                    </button>
                </div>
                <span *ngIf="!this.booleanNAsistente" class="text-danger form-text">Debe contener 3 o más
                    caracteres</span>
            </div>
        </div>

        <div class="row">
            <div class="col-12" formArrayName="asistentes">
                <div class="input-group mb-3" *ngFor="let asistente of asistentesArr.controls; let i = index">

                    <span class="input-group-text">Asistente N° {{i+1}}</span>
                    <input class="form-control" [formControlName]="i">

                    <button class="btn btn-outline-danger ms-2" type="button" (click)="borrarAsistente(i)">
                        Eliminar
                    </button>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12 mb-3">
                <h2 class="text-white">Objetivo</h2>
                <textarea class="form-control" name="objetivo" formControlName="objetivo" id="formObjetivo"
                    placeholder="Describa el objetivo principal de la reunión"></textarea>
                <span class="form-text text-danger" *ngIf="getErrores('objetivo')">Objetivo debe contener 10 o más
                    caracteres</span>
            </div>
        </div>


        <div class="row mb-3">
            <h2 class="text-white">Pendientes y conclusiones de la reunión</h2>
            <div class="input-group" [formGroup]="nuevoPendienteForm">

                <input type="text" class="form-control" name="hecho" id="formHecho" placeholder="¿Qué se debe hacer?"
                    formControlName="hecho">

                <input type="text" class="form-control ms-2" name="responsable" id="formHResponsable"
                    placeholder="Responsble" formControlName="responsable">

                <input type="text" class="form-control ms-2" name="estimado" id="formEstimado"
                    placeholder="Tiempo estimado" formControlName="estimado">

                <button class="btn btn-outline-primary ms-2" type="button" (click)="agregarPendiente()">
                    Agregar
                </button>
            </div>
            <!-- <span *ngIf="getErroresPendientes()" class="col-4 text-danger form-text">Estos campos son obligatorios</span> -->
        </div>

        <div class="row">
            <div class="col-12" formArrayName="pendientes">
                <div class="input-group mb-3" *ngFor="let pendiente of pendientesArr.controls; let i = index"
                    [formGroupName]="i">
                    <!-- *ngFor="let asistente of pendientesArr.controls; let i = index" -->
                    <span class="input-group-text">{{i+1}} </span>
                    <input type="text" class="form-control" name="hecho" placeholder="¿Qué se debe hacer?"
                        formControlName="hecho">

                    <input type="text" class="form-control ms-2" name="responsable" placeholder="Responsble"
                        formControlName="responsable">

                    <input type="text" class="form-control ms-2" name="estimado" placeholder="Tiempo estimado"
                        formControlName="estimado">

                    <button class="btn btn-outline-danger ms-2" type="button" (click)="borrarPendiente(i)">
                        Eliminar
                    </button>
                </div>
            </div>
        </div>

        <div class="row">
            <h2 class="text-white">Datos puntuales</h2>
            <div class="col-4">
                <div class="input-group mb-3">
                    <span class="input-group-text">Próx. reunión</span>
                    <input type="datetime-local" class="form-control" name="proxReunion" id="formProxReunion"
                        formControlName="proxReunion">
                    <span class="text-danger form-text" *ngIf="getErrores('proxReunion')">Debe proporcionar una
                        fecha</span>
                </div>
            </div>

            <div class="col-4">
                <div class="input-group mb-3">
                    <span class="input-group-text">Elaboró</span>
                    <input type="text" class="form-control" name="elaboro" id="formElaboro" formControlName="elaboro"
                        placeholder="Nombre de quien elabora">
                    <span class="text-danger form-text" *ngIf="getErrores('elaboro')">Debe contener 3 o más
                        caracteres</span>
                </div>
            </div>

            <div class="col-4">
                <div class="input-group mb-3">
                    <span class="input-group-text">Autorizó</span>
                    <input type="text" class="form-control" name="autorizo" formControlName="autorizo" id="formAutorizo"
                        placeholder="Nombre de quien autoriza">
                    <span class="text-danger form-text" *ngIf="getErrores('autorizo')">Debe contener 3 o más
                        caracteres</span>
                </div>
            </div>
        </div>

        <div class="text-center mt-2">
            <button type="submit" class="btn btn-primary btn-lg col-4"><i class="bi bi-save"></i> Guardar</button>
        </div>
    </form>

</main>

<!-- <h4 class="text-white">nuevoAsistente invalid</h4>
<pre class="text-white">{{this.nuevoAsistente.invalid | json}} </pre>
<br>
<h4 class="text-white">Asistente Array</h4>
<pre class="text-white">{{asistentesArr.invalid | json}} </pre>
<br>
<h4 class="text-white">Minutaaa</h4>
<pre class="text-white">{{this.minutaForm.invalid | json}} </pre>

<br>
<h4 class="text-white">Minuta Form Value</h4>
<pre class="text-white"> {{this.minutaForm.value | json}} </pre> -->

<app-footer></app-footer>